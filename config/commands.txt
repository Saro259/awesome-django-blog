### Access server
ssh jsolly@69.164.205.120

### Create new migration
 python3 manage.py makemigrations --name changed_my_model your_app_label
 python3 manage.py migrate

 ### Roll back migration
 python3 manage.py migrate blog 0011

After pulling new changes from github
python3 manage.py check --deploy

1 - Modify settings.py as needed
2 - source venv/bib/activate to get the Python virtual env
3 - python3 manage.py migrate (to inherit db changes) # Don't need to makemigrations, because migrations are already in git
4 - sudo chmod -R 777 blogthedata
5 - sudo service apache2 restart  

# Configuring Python install on new Mac
Install using the regular installer from python.org. Make sure to match the version that is on production.
The file path should look like:
/Applications/"Python 3.9"/IDLE.app/Contents/MacOS/Python

Go into Applications/<Python Directory>
Open 'Install Certificates.command'

# login to postgres in terminal
psql -U postgres


# important paths
sudo tail -f /var/log/apache2/access.log
sudo tail -f /var/log/apache2/error.log
sudo nano /etc/django_config.json 
sudo nano -c /etc/apache2/sites-available/django_project.conf
/var/log/postgresql/postgresql-13-main.log
/etc/postgresql-common/createcluster.conf 

# Other useful commands
sudo service postgresql restart
sudo chmod -R 777 blogthedata
become root user -> sudo -i

### Postgres export and restore
sudo -u postgres pg_dump blogthedata > blogthedata_db_3_8_22.sql
scp jsolly@69.164.205.120:/home/jsolly/backups/blogthedata_db_3_8_22.sql .
psql blogthedata < blogthedata_db_3_8_22.sql

# Copy over media folder
scp -r jsolly@69.164.205.120:/home/jsolly/blogthedata/django_project/media .

### Backup Linode
ssh jsolly@69.164.205.120 "dd if=/dev/sda " | dd of=/Users/johnsolly/Documents/code/blogthedata/backups/linode.img


### Code Coverage
coverage run -m unittest discover
coverage report -m --omit tests/tests_isolated.py --skip-empty
coverage html --skip-empty --omit tests/tests_isolated -d blog/templates/htmlcov

### Setup new test database
- Configure settings.py to point to a sqlite database
- run python3 manage.py migrate to create all the tables in sqlite

# Not needed anymore
python3 manage.py collectstatic
scp jsolly@69.164.205.120:/home/jsolly/blogthedata/django_project/db.sqlite3 .